"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var compositionApi=require("@vue/composition-api");function useEvent(e,o,t,n){const u=compositionApi.isRef(e)?e.value:e,i=()=>u.removeEventListener(o,t);return compositionApi.onMounted(()=>u.addEventListener(o,t,n)),compositionApi.onUnmounted(i),i}function unwrap(e){return compositionApi.isRef(e)?e.value:e}function wrap(e){return compositionApi.isRef(e)?e:compositionApi.ref(e)}function minMax(e,o,t){return e<o?o:e>t?t:e}function usePagination(e){const o=wrap(e.currentPage),t=wrap(e.pageSize),n=compositionApi.ref(0),u=wrap(e.total),i=compositionApi.computed({get:()=>n.value,set(e){"number"==typeof e?n.value=Math.min(e,u.value):"production"!==process.env.NODE_ENV&&console.warn(`[offset] expected number but got: '${typeof e}' value: '${e}'`)}}),s=compositionApi.computed({get:()=>o.value,set(e){"number"==typeof e?(o.value=minMax(e,1,c.value),i.value=(o.value-1)*r.value):"production"!==process.env.NODE_ENV&&console.warn(`[currentPage] expected number but got: '${typeof e}' value: '${e}'`)}}),r=compositionApi.computed({get:()=>t.value,set(e){"number"==typeof e?t.value=e:"production"!==process.env.NODE_ENV&&console.warn(`[pageSize] expected number but got: '${typeof e}' value: '${e}'`)}}),c=compositionApi.computed(()=>Math.ceil(u.value/r.value));s.value=o.value;return compositionApi.watch([u,r],()=>{s.value>c.value&&(s.value=c.value)},{lazy:!0}),{pageSize:r,total:u,currentPage:s,offset:i,lastPage:c,next:()=>++s.value,prev:()=>--s.value,first:()=>s.value=1,last:()=>s.value=c.value}}function useArrayPagination(e,o){const t=wrap(e),n=usePagination({currentPage:1,pageSize:10,...o,total:compositionApi.computed(()=>t.value.length)}),u=compositionApi.computed(()=>{const e=t.value;return Array.isArray(e)?e.slice(n.offset.value,n.offset.value+n.pageSize.value):[]});return{...n,result:u}}function useDebounce(e,o){return debounce(e,o)}function debounce(e,o=50,t={isImmediate:!1}){let n;return function(...u){const i=this,s=t.isImmediate&&void 0===n;void 0!==n&&clearTimeout(n),n=setTimeout((function(){n=void 0,t.isImmediate||e.apply(i,u)}),o),s&&e.apply(i,u)}}function useMouseMove(e,o,t){const n=unwrap(e),u=compositionApi.ref(0),i=compositionApi.ref(0);let s=e=>{u.value=e.x,i.value=e.y};const r="number"==typeof o?void 0:o;("number"==typeof o?o:t)&&(s=useDebounce(s,t));const c=useEvent(n,"mousemove",s,r);return{mouseX:u,mouseY:i,remove:c}}function useOnResize(e,o,t){const n=unwrap(e),u=compositionApi.ref(n.clientHeight),i=compositionApi.ref(n.clientWidth);let s=e=>{u.value=n.clientHeight,i.value=n.clientWidth};const r="number"==typeof o?void 0:o;("number"==typeof o?o:t)&&(s=useDebounce(s,t));const c=useEvent(n,"resize",s,r);return{height:u,width:i,remove:c}}function useOnScroll(e,o,t){const n=unwrap(e),u=compositionApi.ref(n.scrollTop),i=compositionApi.ref(n.scrollLeft);let s=e=>{u.value=n.scrollTop,i.value=n.scrollLeft};const r="number"==typeof o?void 0:o;("number"==typeof o?o:t)&&(s=useDebounce(s,t));const c=useEvent(n,"scroll",s,r);return{scrollTop:u,scrollLeft:i,remove:c}}function usePromise(e){if(!e)throw new Error(`[usePromise] argument can't be '${e}'`);if("function"!=typeof e)throw new Error(`[usePromise] expects function, but received ${typeof e}`);const o=compositionApi.ref(!1),t=compositionApi.ref(null),n=compositionApi.ref(null),u=compositionApi.ref();let i=null;return{exec:async(...s)=>{o.value=!0,t.value=null,n.value=null;const r=u.value=i=e(...s);try{const e=await r;return i===r&&(n.value=e),e}catch(e){return void(i===r&&(t.value=e,n.value=null))}finally{i===r&&(o.value=!1)}},result:n,promise:u,loading:o,error:t}}function useCancellablePromise(e){const o=compositionApi.ref(!1);let t=void 0;return{...usePromise((...n)=>(e=>new Promise((n,u)=>{t=e=>{o.value=!0,u(e)},e.then(n).catch(u)}))(e(...n))),cancel:e=>t(e),cancelled:o}}exports.debounce=debounce,exports.useArrayPagination=useArrayPagination,exports.useCancellablePromise=useCancellablePromise,exports.useDebounce=useDebounce,exports.useEvent=useEvent,exports.useMouseMove=useMouseMove,exports.useOnResize=useOnResize,exports.useOnScroll=useOnScroll,exports.usePagination=usePagination,exports.usePromise=usePromise;
