import{isRef as e,onMounted as t,onUnmounted as u,ref as n,computed as l,watch as o}from"@vue/composition-api";function r(n,l,o,r){const a=e(n)?n.value:n,s=()=>a.removeEventListener(l,o);return t(()=>a.addEventListener(l,o,r)),u(s),s}function a(t){return e(t)?t.value:t}function s(t){return e(t)?t:n(t)}function c(e){const t=s(e.currentPage),u=s(e.pageSize),r=n(0),a=s(e.total),c=l({get:()=>r.value,set(e){"number"==typeof e?r.value=Math.min(e,a.value):"production"!==process.env.NODE_ENV&&console.warn(`[offset] expected number but got: '${typeof e}' value: '${e}'`)}}),i=l({get:()=>t.value,set(e){var u,n,l;"number"==typeof e?(t.value=(u=e,n=1,l=f.value,u<n?n:u>l?l:u),c.value=(t.value-1)*v.value):"production"!==process.env.NODE_ENV&&console.warn(`[currentPage] expected number but got: '${typeof e}' value: '${e}'`)}}),v=l({get:()=>u.value,set(e){"number"==typeof e?u.value=e:"production"!==process.env.NODE_ENV&&console.warn(`[pageSize] expected number but got: '${typeof e}' value: '${e}'`)}}),f=l(()=>Math.ceil(a.value/v.value));i.value=t.value;return o([a,v],()=>{i.value>f.value&&(i.value=f.value)},{lazy:!0}),{pageSize:v,total:a,currentPage:i,offset:c,lastPage:f,next:()=>++i.value,prev:()=>--i.value,first:()=>i.value=1,last:()=>i.value=f.value}}function i(e,t){const u=s(e),n=c({currentPage:1,pageSize:10,...t,total:l(()=>u.value.length)}),o=l(()=>{const e=u.value;return Array.isArray(e)?e.slice(n.offset.value,n.offset.value+n.pageSize.value):[]});return{...n,result:o}}function v(e,t){return f(e,t)}function f(e,t=50,u={isImmediate:!1}){let n;return function(...l){const o=this,r=u.isImmediate&&void 0===n;void 0!==n&&clearTimeout(n),n=setTimeout((function(){n=void 0,u.isImmediate||e.apply(o,l)}),t),r&&e.apply(o,l)}}function p(e,t,u){const l=a(e),o=n(0),s=n(0);let c=e=>{o.value=e.x,s.value=e.y};const i="number"==typeof t?void 0:t;("number"==typeof t?t:u)&&(c=v(c,u));const f=r(l,"mousemove",c,i);return{mouseX:o,mouseY:s,remove:f}}function m(e,t,u){const l=a(e),o=n(l.clientHeight),s=n(l.clientWidth);let c=e=>{o.value=l.clientHeight,s.value=l.clientWidth};const i="number"==typeof t?void 0:t;("number"==typeof t?t:u)&&(c=v(c,u));const f=r(l,"resize",c,i);return{height:o,width:s,remove:f}}function d(e,t,u){const l=a(e),o=n(l.scrollTop),s=n(l.scrollLeft);let c=e=>{o.value=l.scrollTop,s.value=l.scrollLeft};const i="number"==typeof t?void 0:t;("number"==typeof t?t:u)&&(c=v(c,u));const f=r(l,"scroll",c,i);return{scrollTop:o,scrollLeft:s,remove:f}}function y(e){if(!e)throw new Error(`[usePromise] argument can't be '${e}'`);if("function"!=typeof e)throw new Error(`[usePromise] expects function, but received ${typeof e}`);const t=n(!1),u=n(null),l=n(null),o=n();let r=null;return{exec:async(...n)=>{t.value=!0,u.value=null,l.value=null;const a=o.value=r=e(...n);try{const e=await a;return r===a&&(l.value=e),e}catch(e){return void(r===a&&(u.value=e,l.value=null))}finally{r===a&&(t.value=!1)}},result:l,promise:o,loading:t,error:u}}function g(e){const t=n(!1);let u=void 0;return{...y((...n)=>(e=>new Promise((n,l)=>{u=e=>{t.value=!0,l(e)},e.then(n).catch(l)}))(e(...n))),cancel:e=>u(e),cancelled:t}}function h(e){const t=n(null),u=n(null),o=y(async n=>{const l=await fetch(n,e);if(!e||!1!==e.isJson){const n=l.json().then(e=>t.value=e).catch(e=>{t.value=null,u.value=e});e&&!1===e.parseImmediate||await n}return l}),r=l(()=>o.result.value&&o.result.value.status||null),a=l(()=>o.result.value&&o.result.value.statusText||null);return{...o,json:t,jsonError:u,status:r,statusText:a}}export{f as debounce,i as useArrayPagination,g as useCancellablePromise,v as useDebounce,r as useEvent,h as useFetch,p as useMouseMove,m as useOnResize,d as useOnScroll,c as usePagination,y as usePromise};
